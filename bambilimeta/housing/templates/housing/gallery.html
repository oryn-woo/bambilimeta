<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Gallery — Mobile-first</title>

  <!-- Bootstrap CSS (5.3) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    /* Mobile-first base styles */
    :root{
      --pink-outline: rgba(255,182,193,0.85);
      --gold: #d4af37;
      --gold-hover: #ffd86b;
      --thumb-radius: 0.6rem;
    }

    body { background:#faf9fb; font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; padding:1rem; }

    .gallery {
      display:flex;
      flex-direction:column;
      gap:1rem;
    }

    /* Carousel container styling */
    .carousel-wrapper {
      border-radius: 1rem;
      padding: .45rem;
      outline: 3px solid var(--pink-outline);
      background: white;
      overflow: hidden;
    }
    .carousel-inner img { object-fit: cover; width:100%; height:100%; display:block; }

    /* Thumbnail base (horizontal row under carousel on mobile) */
    .thumb-row,
    .thumb-below {
      display:flex;
      gap:.6rem;
      flex-wrap:wrap;
      align-items:center;
    }
    .thumb {
      display:block;
      flex: 0 0 auto;
      width: 72px;
      height: 72px;
      border-radius: var(--thumb-radius);
      overflow:hidden;
      border: 2px solid transparent;
      box-shadow: 0 2px 6px rgba(0,0,0,0.06);
      cursor:pointer;
      transition: transform .18s ease, box-shadow .18s ease, border-color .18s ease;
      background: #fff;
    }
    .thumb img { width:100%; height:100%; object-fit:cover; display:block; }

    .thumb.active {
      border-color: var(--pink-outline);
      box-shadow: 0 6px 18px rgba(255,182,193,0.16);
      outline: 3px solid rgba(255,182,193,0.15);
    }

    /* bubble / jello click animation */
    @keyframes bubble {
      0% { transform: scale(1); }
      30% { transform: scale(1.12); }
      50% { transform: scale(.95) rotate(-3deg); }
      70% { transform: scale(1.05) rotate(2deg); }
      100% { transform: scale(1); }
    }
    .thumb.bubble { animation: bubble .6s cubic-bezier(.2,.8,.2,1); }

    /* Desktop / large screens layout:
       Left: vertical thumbnail column (max 20% width)
       Right: carousel takes remaining width (~80%)
    */
    @media (min-width: 992px) { /* large screens and above */
      .gallery {
        display:grid;
        grid-template-columns: 20% 1fr;
        gap:1.25rem;
        align-items:start;
      }

      /* Vertical thumbnail column */
      .thumb-column {
        display:flex;
        flex-direction:column;
        gap:1rem;
        max-height: none; /* we'll handle programmatically */
        align-items:center;
      }
      .thumb-column .thumb{
        width: 72px;
        height: 72px;
        margin: 0;
      }

      .thumb-below {
        grid-column: 1 / -1; /* below the grid */
        margin-top: .6rem;
      }

      /* carousel wrapper in the right column */
      .carousel-wrapper { width:100%; height: 420px; }
      .carousel-inner .carousel-item { height: 100%; }
      .carousel-inner .carousel-item img { height: 100%; width:100%; }
    }

    /* Carousel controls: circular with gold outline */
    .carousel-control-prev, .carousel-control-next {
      width:48px;
      height:48px;
      background: rgba(255,255,255,0.9);
      border-radius:50%;
      border: 2px solid var(--gold);
      display:flex;
      align-items:center;
      justify-content:center;
      top:50%;
      transform:translateY(-50%);
      opacity:1;
      transition: background .15s ease, transform .15s ease;
    }
    .carousel-control-prev:hover, .carousel-control-next:hover {
      background: var(--gold-hover);
      transform: translateY(-50%) scale(1.06);
      color: black;
    }
    .carousel-control-prev-icon,
    .carousel-control-next-icon {
      filter: none;
      background-image: none;
      font-size: 1.1rem;
      color: var(--gold);
    }

    /* indicators (dots) - subtle */
    .carousel-indicators [data-bs-target] {
      width:10px;
      height:10px;
      border-radius:50%;
      background: rgba(0,0,0,0.18);
    }
    .carousel-indicators .active {
      background: var(--pink-outline);
      box-shadow: 0 0 0 3px rgba(255,182,193,0.12);
    }

    /* small niceties for spacing on large screens */
    .thumb-column { padding-top: .4rem; }
    .thumb-column .thumb { margin-bottom: .9rem; }

  </style>
</head>
<body>

  <main class="container">
    <h2 class="mb-3">House Gallery</h2>

    <section class="gallery" id="gallery">

      <!-- Left thumbnails (on mobile they become horizontal row above below container) -->
      <div class="thumb-column" id="thumbColumn" aria-hidden="false">
        <!-- Thumbnails are generated below with data-index to match carousel slides -->
        <!-- Example thumbnails -->
        <button class="thumb" data-index="0" aria-label="Photo 1"><img src="https://picsum.photos/id/1018/200/200" alt="Photo 1"></button>
        <button class="thumb" data-index="1" aria-label="Photo 2"><img src="https://picsum.photos/id/1015/200/200" alt="Photo 2"></button>
        <button class="thumb" data-index="2" aria-label="Photo 3"><img src="https://picsum.photos/id/1016/200/200" alt="Photo 3"></button>
        <button class="thumb" data-index="3" aria-label="Photo 4"><img src="https://picsum.photos/id/1020/200/200" alt="Photo 4"></button>
        <button class="thumb" data-index="4" aria-label="Photo 5"><img src="https://picsum.photos/id/1024/200/200" alt="Photo 5"></button>
        <button class="thumb" data-index="5" aria-label="Photo 6"><img src="https://picsum.photos/id/1035/200/200" alt="Photo 6"></button>
      </div>

      <!-- Carousel (right column on desktop, top on mobile) -->
      <div class="carousel-wrapper">
        <div id="houseCarousel" class="carousel slide" data-bs-ride="false">
          <div class="carousel-inner">
            <div class="carousel-item active">
              <img src="https://picsum.photos/id/1018/1200/700" class="d-block w-100" alt="Photo 1">
            </div>
            <div class="carousel-item">
              <img src="https://picsum.photos/id/1015/1200/700" class="d-block w-100" alt="Photo 2">
            </div>
            <div class="carousel-item">
              <img src="https://picsum.photos/id/1016/1200/700" class="d-block w-100" alt="Photo 3">
            </div>
            <div class="carousel-item">
              <img src="https://picsum.photos/id/1020/1200/700" class="d-block w-100" alt="Photo 4">
            </div>
            <div class="carousel-item">
              <img src="https://picsum.photos/id/1024/1200/700" class="d-block w-100" alt="Photo 5">
            </div>
            <div class="carousel-item">
              <img src="https://picsum.photos/id/1035/1200/700" class="d-block w-100" alt="Photo 6">
            </div>
          </div>

          <!-- controls (restyled circles) -->
          <button class="carousel-control-prev" type="button" data-bs-target="#houseCarousel" data-bs-slide="prev" aria-label="Previous">
            <span class="carousel-control-prev-icon" aria-hidden="true">&larr;</span>
          </button>
          <button class="carousel-control-next" type="button" data-bs-target="#houseCarousel" data-bs-slide="next" aria-label="Next">
            <span class="carousel-control-next-icon" aria-hidden="true">&rarr;</span>
          </button>

          <!-- indicators -->
          <div class="carousel-indicators">
            <button type="button" data-bs-target="#houseCarousel" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
            <button type="button" data-bs-target="#houseCarousel" data-bs-slide-to="1" aria-label="Slide 2"></button>
            <button type="button" data-bs-target="#houseCarousel" data-bs-slide-to="2" aria-label="Slide 3"></button>
            <button type="button" data-bs-target="#houseCarousel" data-bs-slide-to="3" aria-label="Slide 4"></button>
            <button type="button" data-bs-target="#houseCarousel" data-bs-slide-to="4" aria-label="Slide 5"></button>
            <button type="button" data-bs-target="#houseCarousel" data-bs-slide-to="5" aria-label="Slide 6"></button>
          </div>
        </div>
      </div>

      <!-- Bottom thumbnails row (receives overflow thumbnails on large screens,
           on mobile it's simply the below row that will contain duplicates if needed) -->
      <div class="thumb-below" id="thumbBelow" aria-hidden="false"></div>

    </section>
  </main>

  <!-- Bootstrap JS (bundle includes Popper) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // Utility to compute outer height including margins
    function outerHeight(el){
      const style = getComputedStyle(el);
      return el.offsetHeight + parseFloat(style.marginTop || 0) + parseFloat(style.marginBottom || 0);
    }

    // Rearrange thumbnails: keep as many vertically as fit the carousel height,
    // move the rest to the below-row. Runs on load and on resize.
    function arrangeThumbnails(){
      const thumbColumn = document.getElementById('thumbColumn');
      const thumbBelow = document.getElementById('thumbBelow');
      const carouselWrapper = document.querySelector('.carousel-wrapper');

      // Move all thumbnails back to the column first
      const allThumbs = Array.from(thumbBelow.children).concat(Array.from(thumbColumn.children));
      thumbColumn.innerHTML = '';
      thumbBelow.innerHTML = '';

      allThumbs.forEach(t => thumbColumn.appendChild(t));

      // only reflow into below if large screens (>= 992px) — mobile shows horizontal row below anyway
      if(window.matchMedia('(min-width: 992px)').matches){
        const carouselHeight = carouselWrapper.clientHeight;
        let cum = 0;
        const thumbs = Array.from(thumbColumn.children);
        // Keep accumulating until next would overflow
        for(let i=0; i<thumbs.length; i++){
          const h = outerHeight(thumbs[i]);
          if(cum + h <= carouselHeight){
            cum += h;
            // keep it in column
          } else {
            // move this and all subsequent to the below-row
            for(let j=i; j<thumbs.length; j++){
              thumbBelow.appendChild(thumbs[j]);
            }
            break;
          }
        }
      } else {
        // On mobile, we want thumbnails horizontally under carousel (thumbBelow)
        // For visual parity, move all thumbs to thumbBelow (carousel top)
        const thumbs = Array.from(thumbColumn.children);
        thumbs.forEach(t => thumbBelow.appendChild(t));
      }
      // Keep first thumbnail marked active if none active
      if(!document.querySelector('.thumb.active')){
        const first = document.querySelector('.thumb');
        if(first) first.classList.add('active');
      }
    }

    document.addEventListener('DOMContentLoaded', function(){
      // initial arrangement
      arrangeThumbnails();

      // wire up thumbnail click -> carousel slide
      const carouselEl = document.getElementById('houseCarousel');
      const bsCarousel = bootstrap.Carousel.getOrCreateInstance(carouselEl, { ride: false });

      function onThumbClick(evt){
        const btn = evt.currentTarget;
        const idx = parseInt(btn.dataset.index, 10);
        if(isNaN(idx)) return;
        bsCarousel.to(idx);

        // highlight
        document.querySelectorAll('.thumb').forEach(t => t.classList.remove('active'));
        btn.classList.add('active');

        // bubble animation
        btn.classList.remove('bubble');
        // force reflow to restart animation if needed
        void btn.offsetWidth;
        btn.classList.add('bubble');

        // Remove bubble class after animation completes
        setTimeout(() => btn.classList.remove('bubble'), 700);
      }

      function wireThumbs(){
        document.querySelectorAll('.thumb').forEach(t => {
          t.removeEventListener('click', onThumbClick);
          t.addEventListener('click', onThumbClick);
        });
      }

      wireThumbs();

      // Update active thumbnail when carousel slides (so keyboard / controls stay in sync)
      carouselEl.addEventListener('slid.bs.carousel', function(e){
        const to = e.to;
        document.querySelectorAll('.thumb').forEach(t => t.classList.remove('active'));
        const sel = document.querySelector('.thumb[data-index="'+to+'"]');
        if(sel) sel.classList.add('active');

        // If the active thumbnail is in the below row and on large screen
        // scroll it into view (optional UX improvement)
        if(window.matchMedia('(min-width: 992px)').matches && sel){
          // if the selected thumb is inside thumbBelow, briefly scroll it into view
          if(document.getElementById('thumbBelow').contains(sel)){
            sel.scrollIntoView({ behavior: 'smooth', inline: 'center' });
          }
        }
      });

      // Recalculate arrangement on resize and whenever fonts/images load
      let resizeTimer = null;
      window.addEventListener('resize', function(){
        clearTimeout(resizeTimer);
        resizeTimer = setTimeout(function(){
          arrangeThumbnails();
          wireThumbs();
        }, 120);
      });

      // Also re-arrange after window load (images loaded)
      window.addEventListener('load', function(){
        arrangeThumbnails();
        wireThumbs();
      });

    });
  </script>
</body>
</html>
